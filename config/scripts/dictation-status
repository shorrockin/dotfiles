#!/usr/bin/env bash
# Waybar module for dictation status
# Returns JSON for waybar custom module with animated audio bars

STATE_FILE="/tmp/dictation.state"

# Audio bar characters (different heights)
BARS=("▁" "▂" "▃" "▄" "▅" "▆" "▇")

random_bar() {
    echo "${BARS[$((RANDOM % ${#BARS[@]}))]}"
}

if [ -f "$STATE_FILE" ]; then
    # Generate 5 random bars to simulate audio visualization
    DISPLAY="$(random_bar)$(random_bar)$(random_bar)$(random_bar)$(random_bar)"
    echo "{\"text\": \"$DISPLAY\", \"tooltip\": \"Recording...\", \"class\": \"recording\"}"
else
    echo '{"text": "", "tooltip": "", "class": "empty"}'
fi
